---
title: "Random effects meta-analysis for correlated test statistics"
author:
- name: "[Gabriel Hoffman](http://gabrielhoffman.github.io)"
  affiliation: | 
    Icahn School of Medicine at Mount Sinai, New York
abstract: > 
  Better description here
  rema v`r packageVersion("rema")`<br> 
  `r format(Sys.time(),'%B %d, %Y %H:%M:%S')`<br>  

output:
  rmarkdown::html_document:
    highlight: pygments
    toc: true
    toc_depth: 3
    fig_width: 5
bibliography: REFERENCES.bib
vignette: >
  %\VignetteIndexEntry{Random effects meta-analysis (rema) for correlated test statistics}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
  %\usepackage[utf8]{inputenc}
---

<!---
cd /Users/gabrielhoffman/workspace/repos
R
library('knitr')
rmarkdown::render('rema/vignettes/rema.Rmd')
--->

```{r setup, echo=FALSE, results="hide"}
knitr::opts_chunk$set(tidy=FALSE, cache=TRUE,
                      dev="png",
                      package.startup.message = FALSE,
                      message=FALSE, error=FALSE, warning=TRUE)
options(width=100)
```	

```{r rema, results='hide'}
library(rema)
library(metafor)

# Generate effects
library(mvtnorm)
library(clusterGeneration )

n = 4
Sigma = cov2cor(genPositiveDefMat(n)$Sigma)
beta = t(rmvnorm(1, rep(0, n), Sigma))
stders = rep(.1, n)

# Run fixed effects meta-analysis, 
# assume identity correlation  
LS( beta, stders)

# Run random effects meta-analysis,
# assume identity correlation  
RE2C( beta, stders)

# Standard fixed effects meta-analysis
# of independent effects with metafor pacakge
rma( beta, stders, method="FE")

# Standard random effects meta-analysis
# of independent effects with metafor pacakge
rma( beta, stders, method="REML")

# Run fixed effects meta-analysis, 
# account for correlation 
LS( beta, stders, Sigma)

# Run random effects meta-analysis,
# account for correlation 
RE2C( beta, stders, Sigma)
```

#### Description
`LS()` implements fixed effect meta-analysis for correlated test statistics using method of @lin2009meta.  By default, correlation is set to identity matrix to for independent test statistics.  
#'

Perform random effect meta-analysis for correlated test statistics using RE2 method of @han2011random, or RE2 for correlated test statistics from @han2016general.  Also uses RE2C method of @lee2017increasing to further test for heterogenity in effect size. By default, correlation is set to identity matrix to for independent test statistics.  


# Power analysis
```{r power}

M = 20
Sigma = cov2cor(genPositiveDefMat(n)$Sigma)
beta = t(rmvnorm(1, rep(0, n), Sigma))
stders = rep(.1, n)



```

```{r power.plot}


```










# Session info
```{r sessionInfo}
sessionInfo()
```

## References
