<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Random effect meta-analysis for correlated test statistics — RE2C • remaCor</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Random effect meta-analysis for correlated test statistics — RE2C"><meta name="description" content="Random effect meta-analysis for correlated test statistics using RE2C"><meta property="og:description" content="Random effect meta-analysis for correlated test statistics using RE2C"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">remaCor</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.20</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/remaCor.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/DiseaseNeurogenomics/remaCor/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Random effect meta-analysis for correlated test statistics</h1>
      <small class="dont-index">Source: <a href="https://github.com/DiseaseNeurogenomics/remaCor/blob/master/R/RE2C.R" class="external-link"><code>R/RE2C.R</code></a></small>
      <div class="d-none name"><code>RE2C.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Random effect meta-analysis for correlated test statistics using RE2C</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">RE2C</span><span class="op">(</span><span class="va">beta</span>, <span class="va">stders</span>, cor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">beta</span><span class="op">)</span><span class="op">)</span>, twoStep <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-beta">beta<a class="anchor" aria-label="anchor" href="#arg-beta"></a></dt>
<dd><p>regression coefficients from each analysis</p></dd>


<dt id="arg-stders">stders<a class="anchor" aria-label="anchor" href="#arg-stders"></a></dt>
<dd><p>standard errors corresponding to betas</p></dd>


<dt id="arg-cor">cor<a class="anchor" aria-label="anchor" href="#arg-cor"></a></dt>
<dd><p>correlation matrix between of test statistics.  Default considers uncorrelated test statistics</p></dd>


<dt id="arg-twostep">twoStep<a class="anchor" aria-label="anchor" href="#arg-twostep"></a></dt>
<dd><p>Apply two step version of RE2C that is designed to be applied only after the fixed effect model.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>

<dl><dt>stat1:</dt>
<dd><p>statistic testing effect mean</p></dd>

<dt>stat2:</dt>
<dd><p>statistic testing effect heterogeneity</p></dd>

<dt>RE2Cp:</dt>
<dd><p>RE2 p-value accounting for correlelation between tests</p></dd>

<dt>RE2Cp.twoStep:</dt>
<dd><p>two step RE2C test after fixed effect test.  Only evaluated if <code>twoStep==TRUE</code></p></dd>

<dt>QE:</dt>
<dd><p>test statistic for the test of (residual) heterogeneity</p></dd>

<dt>QEp:</dt>
<dd><p>p-value for the test of (residual) heterogeneity</p></dd>

<dt>Isq:</dt>
<dd><p>I^2 statistic</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Perform random effect meta-analysis for correlated test statistics using RE2 method of Han and Eskin (2011)
, or RE2 for correlated test statistics from Han et al. (2016)
.  Also uses RE2C method of Lee et al. (2017)
 to further test for heterogenity in effect size. By default, correlation is set to identity matrix to for independent test statistics.</p>
<p>This method requires the correlation matrix to be symmatric positive definite (SPD).  If this condition is not satisfied, results will be NA.  If the matrix is not SPD, there is likely an issue with how it was generated.</p>

<p>For computing <code>Q</code>, <code>QEp</code>, and <code>Isq</code>, the effective number of independent studies is determined by <code>sum(solve(cor))</code> (Liu and Liang 1997)
.  When the correlation is diagonal, the studies are independent and this value is simply the number of studies.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Han B, Duong D, Sul JH, de Bakker PI, Eskin E, Raychaudhuri S (2016).
“A general framework for meta-analyzing dependent studies with overlapping subjects in association mapping.”
<em>Human Molecular Genetics</em>, <b>25</b>(9), 1857–1866.
<a href="https://doi.org/10.1093/hmg/ddw049" class="external-link">https://doi.org/10.1093/hmg/ddw049</a>.<br><br> Han B, Eskin E (2011).
“Random-effects model aimed at discovering associations in meta-analysis of genome-wide association studies.”
<em>The American Journal of Human Genetics</em>, <b>88</b>(5), 586–598.
<a href="https://doi.org/10.1016/j.ajhg.2011.04.014" class="external-link">https://doi.org/10.1016/j.ajhg.2011.04.014</a>.<br><br> Lee CH, Eskin E, Han B (2017).
“Increasing the power of meta-analysis of genome-wide association studies to detect heterogeneous effects.”
<em>Bioinformatics</em>, <b>33</b>(14), i379–i388.
<a href="https://doi.org/10.1093/bioinformatics/btx242" class="external-link">https://doi.org/10.1093/bioinformatics/btx242</a>.<br><br> Liu G, Liang K (1997).
“Sample size calculations for studies with correlated observations.”
<em>Biometrics</em>, 937–947.
<a href="https://doi.org/10.2307/2533554" class="external-link">https://doi.org/10.2307/2533554</a>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">clusterGeneration</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://mvtnorm.R-forge.R-project.org" class="external-link">mvtnorm</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># sample size</span></span></span>
<span class="r-in"><span><span class="va">n</span> <span class="op">=</span> <span class="fl">30</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># number of response variables</span></span></span>
<span class="r-in"><span><span class="va">m</span> <span class="op">=</span> <span class="fl">6</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Error covariance</span></span></span>
<span class="r-in"><span><span class="va">Sigma</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/clusterGeneration/man/genPositiveDefMat.html" class="external-link">genPositiveDefMat</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span><span class="op">$</span><span class="va">Sigma</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># regression parameters</span></span></span>
<span class="r-in"><span><span class="va">beta</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">.6</span>, <span class="fl">1</span>, <span class="va">m</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># covariates</span></span></span>
<span class="r-in"><span><span class="va">X</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>, ncol<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Simulate response variables</span></span></span>
<span class="r-in"><span><span class="va">Y</span> <span class="op">=</span> <span class="va">X</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">beta</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="va">n</span>, sigma <span class="op">=</span> <span class="va">Sigma</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Multivariate regression</span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">X</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Correlation between residuals</span></span></span>
<span class="r-in"><span><span class="va">C</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html" class="external-link">residuals</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Extract effect sizes and standard errors from model fit</span></span></span>
<span class="r-in"><span><span class="va">df</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">a</span><span class="op">)</span> </span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>beta <span class="op">=</span> <span class="va">a</span><span class="op">[</span><span class="st">"X"</span>, <span class="fl">1</span><span class="op">]</span>, se <span class="op">=</span> <span class="va">a</span><span class="op">[</span><span class="st">"X"</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">df</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="va">df</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Run fixed effects meta-analysis, </span></span></span>
<span class="r-in"><span><span class="co"># assume identity correlation  </span></span></span>
<span class="r-in"><span><span class="fu"><a href="LS.html">LS</a></span><span class="op">(</span> <span class="va">df</span><span class="op">$</span><span class="va">beta</span>, <span class="va">df</span><span class="op">$</span><span class="va">se</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        beta       se           p</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 0.4004915 0.147962 0.006795195</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Run random effects meta-analysis,</span></span></span>
<span class="r-in"><span><span class="co"># assume identity correlation  </span></span></span>
<span class="r-in"><span><span class="fu">RE2C</span><span class="op">(</span> <span class="va">df</span><span class="op">$</span><span class="va">beta</span>, <span class="va">df</span><span class="op">$</span><span class="va">se</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      stat1 stat2      RE2Cp RE2Cp.twoStep       QE       QEp Isq</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 7.326322     0 0.01255951            NA 3.585407 0.6105057   0</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Run fixed effects meta-analysis, </span></span></span>
<span class="r-in"><span><span class="co"># account for correlation </span></span></span>
<span class="r-in"><span><span class="fu"><a href="LS.html">LS</a></span><span class="op">(</span> <span class="va">df</span><span class="op">$</span><span class="va">beta</span>, <span class="va">df</span><span class="op">$</span><span class="va">se</span>, <span class="va">C</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        beta        se          p</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 0.4657671 0.1684852 0.00570209</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Run random effects meta-analysis,</span></span></span>
<span class="r-in"><span><span class="co"># account for correlation </span></span></span>
<span class="r-in"><span><span class="fu">RE2C</span><span class="op">(</span> <span class="va">df</span><span class="op">$</span><span class="va">beta</span>, <span class="va">df</span><span class="op">$</span><span class="va">se</span>, <span class="va">C</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      stat1     stat2       RE2Cp RE2Cp.twoStep       QE       QEp      Isq</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 7.642119 0.3393766 0.009417392            NA 3.780033 0.3747031 4.994907</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="http://gabrielhoffman.github.io" class="external-link">Gabriel Hoffman</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

